# Block access to sensitive files
location ~ /\.(env|git|htaccess|htpasswd|svn|DS_Store) {
    return 444;
}

location ~ /\.(bak|config|sql|ini|log|sh|inc|swp|dist)$ {
    return 444;
}

# Block WordPress sensitive paths
location ~ ^/(wp-config\.php|xmlrpc\.php|wp-admin/install\.php) {
    return 444;
}

# Block common scanner paths
location ~ ^/(\.well-known/security\.txt|_profiler|_wdt|debug|console|telescope|adminer|phpmyadmin|pma|myadmin|mysql|sqlmanager)$ {
    return 444;
}

# Block common vulnerability scanners user agents
if ($http_user_agent ~* (nikto|sqlmap|nmap|nessus|openvas|w3af|acunetix|netsparker|qualys|gobuster|dirbuster|wpscan|hydra|medusa|zgrab|masscan|censys|shodan)) {
    return 444;
}

# Block empty user agents (common for bots/scanners)
if ($http_user_agent = "") {
    return 444;
}
